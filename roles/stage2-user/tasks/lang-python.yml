---
- tags: python
  block:
    - name: create pip configuration directory
      file:
        name: '{{ ansible_env.HOME }}/.config/pip/'
        state: directory

    - name: create pip configuration
      copy:
        src: 'config/pip/pip.conf'
        dest: '{{ ansible_env.HOME }}/.config/pip/pip.conf'

    - name: create virtualenv directory
      file:
        name: '{{ ansible_env.HOME }}/.virtualenvs'
        state: directory

    - name: create virtualenv configuration
      copy:
        src: '{{ item }}'
        dest: '{{ ansible_env.HOME }}/.virtualenvs/{{ item }}'
        mode: '0755'
      with_items:
        - postmkvirtualenv

    - name: install python packages
      pip:
        name: '{{ item }}'
        state: latest
        executable: pip3
        extra_args: --user
      with_items:
        - ctop
        - httpie
        - peru
        - pip
        - pipenv
        - secretstorage
        - ssh-run
        - tox
        - v
        - watch-fs
        - wheel
