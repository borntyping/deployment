---
- tags:
    - stage2
    - stage2-user
  block:
    - name: install python packages
      pip:
        name:
          - black
          - flake8
          - httpie
          - mypy
          - peru
          - pip
          - pipenv
          - poetry
          - pytest
        state: latest
        executable: pip3
        extra_args: --user
      tags:
        - python
        - bin

    - name: configure dotfiles
      copy:
        src: '{{ item }}'
        dest: '{{ lookup("env", "HOME") }}/.{{ item }}'
      with_items:
        - ackrc
        - htoprc
        - inputrc
        - multitailrc
        - tmux.conf
      tags:
        - dotfiles

    - name: install executables and scripts
      copy:
        src: '.local/bin/'
        dest: '{{ lookup("env", "HOME") }}/.local/bin'
        mode: '0755'
      tags:
        - bin
        - bindir
        - ansible
        - micro

    - import_tasks: lang-zsh.yml
    - import_tasks: tool-git.yml
    - import_tasks: tool-micro.yml
    - import_tasks: tool-ssh.yml

    - meta: flush_handlers
